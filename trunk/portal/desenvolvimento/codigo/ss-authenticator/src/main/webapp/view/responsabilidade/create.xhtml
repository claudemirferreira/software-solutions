<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fpf2="http://java.sun.com/jsf/composite/jsf2_component"
	template="/resources/layout/register_template.xhtml">

	<ui:param name="pageTitle" value="Cadastro de Responsabilidade"/>
	<ui:param name="pageHeader" value="Cadastro de Responsabilidade"/>
	<ui:param name="managedBean" value="#{responsabilidadeBean}"/>

	<ui:define name="register_region">
	
		<p:panel header="Dados do responsabilidade">
		
			<fpf2:comboBox label="Sistema" 
							value="#{responsabilidadeBean.entity.sistema}" 
							list="#{sistemasAtivos}" 
							atributo="#{item.txSistema}" 
							foreignKey="true" selectOne="true" 
							disabled="#{sistemaBean.entity.persistent}" />
		
			<fpf2:input id="Responsabilidade" 
						value="#{responsabilidadeBean.entity.txResponsabilidade}" 
						label="Nome"
						maxlength="100"
						required="true"/>
			
			<fpf2:input id="Descrição" 
						value="#{responsabilidadeBean.entity.txDescricao}" 
						label="Descrição"
						maxlength="300"
						required="true"/>
						
			<fpf2:comboBox value="#{responsabilidadeBean.entity.sistema}" 
					required="true" 
					list="#{sistemasAtivos}"
					atributo="#{item.txSistema}"
					foreignKey="true"
					selectOne="true"
					label="Sistema"/>
								
			<fpf2:checkBox value="#{responsabilidadeBean.entity.ativo}" label="Ativo" required="true" />
			
		</p:panel>
			
		<p:spacer height="10px" />	
			
		<p:panel id="pnlGridServico">
			
			<!-- TODO grid -->
		
			<p:commandLink value="Novo" onclick="dlgServicos.show();" />
			
			<fpf2:grid list="#{responsabilidadeBean.entity.responsabilidadeServicos}">
				
				<p:column style="text-align:left">  
		            <f:facet name="header">  
		                <h:outputText value="Serviço" />  
		            </f:facet>  
		            <h:outputText value="#{item.servico.txServico}" />  
		        </p:column>  
				
			</fpf2:grid>
		
			
			<p:dialog id="dlgServicos" header="Novo Serviço" widgetVar="item" dynamic="true">  
			    
			    TODO: carregar servicos do sistema..
			    
			</p:dialog>  
			
		</p:panel>
				

	</ui:define>

</ui:composition>