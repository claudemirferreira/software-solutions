
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ss="http://java.sun.com/jsf/composite/jsf2_component"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">

	<p:outputPanel id="pnlCadMat" rendered="#{alunoMatriculaControlador.modalCadastro}">
	
		<h:panelGrid id="pnlCad" columnClasses="grid" style="padding: 2px 0px 0px 4px;">
			
			<ss:comboBox id="turma" label="Turma" required="true" foreignKey="true" selectOne="true"
						value="#{alunoMatriculaControlador.matricula.turma}"
						atributo="#{item.curso.nome} - #{item.turno} - #{item.ano}"
						list="#{alunoMatriculaControlador.turmas}" >
						
						<!-- FIXME event no componente -->
				<p:ajax event="change" 
						update=":formDlg:valor :formDlg:vagas :formDlg:cmbInteg" 
						listener="#{alunoMatriculaControlador.selectTurma(true)}"/>  
			</ss:comboBox>
			
			<ss:input id="vagas" label="Vagas Disponíveis"
						size="5" readonly="true" type="number"
						value="#{alunoMatriculaControlador.matricula.turma.vagasDisponiveis}" />
			
			<ss:input id="valor" label="Valor" required="true" value="#{alunoMatriculaControlador.matricula.valor}" dir="rtl" />
			
			<ss:input label="Data da Matrícula" type="date" required="true" value="#{alunoMatriculaControlador.matricula.data}" dir="rtl" />
			
			<ss:comboBox label="Mensalidades apartir de" required="true" selectOne="true" 
						value="#{alunoMatriculaControlador.mesSelecionado}" 
						list="#{alunoMatriculaControlador.mesesList}" />
	        
	        <ss:comboBox label="Turno Integral?" required="true" selectOne="true" 
						value="#{alunoMatriculaControlador.matricula.integral}"
						list="#{alunoMatriculaControlador.naoSimList}" />
	        
	        <ss:comboBox label="Situação" required="true" selectOne="true" 
						value="#{alunoMatriculaControlador.matricula.status}"
						list="#{alunoMatriculaControlador.statusMatriculaList}" >
				<p:ajax event="change" update=":formDlg:pnlObservacao"
						listener="#{alunoMatriculaControlador.renderObservacao}"/>  
			</ss:comboBox>
	        
		</h:panelGrid>
		
        <p:outputPanel id="pnlObservacao">
			<p:fieldset legend="Justificativa" rendered="#{alunoMatriculaControlador.matricula.status.id ne 0}" >  
				<p:inputTextarea value="#{alunoMatriculaControlador.observacaoMatricula.txObservacao}" 
								maxlength="250" cols="95" rows="4" autoResize="false"
								required="true" >
					<p:ajax event="change" update=":formDlg:pnlObservacao" /> 
				</p:inputTextarea>
			</p:fieldset>
		</p:outputPanel>
		
		
		<p:commandButton id="btnRetornar" value="Retornar" update=":formDlg"
						icon="ui-icon-circle-arrow-w" styleClass="ui-priority-primary"
						oncomplete="PF('dlgMatricula').show();"
						action="#{alunoMatriculaControlador.showModalPesquisaMatricula}" 
						immediate="true" />
	
		<p:commandButton id="btnCadastro" value="Salvar" update=":formDlg"
						icon="ui-icon-disk" styleClass="ui-priority-primary"
						oncomplete="PF('dlgMatricula').show();"
						action="#{alunoMatriculaControlador.salvarMatricula}" />
           	
		
	</p:outputPanel>
		
</ui:component>