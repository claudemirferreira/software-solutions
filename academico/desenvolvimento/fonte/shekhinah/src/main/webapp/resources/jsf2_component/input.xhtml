<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:f="http://java.sun.com/jsf/core">

	<cc:interface>
	
		<cc:attribute name="id" required="false" default="id" />
		<cc:attribute name="label" required="false" />	
		<cc:attribute name="value" required="true" />
		<cc:attribute name="required" required="false" default="false" />
		
		<cc:attribute name="size" default="30"  />
		<cc:attribute name="align" default="left" />
		<cc:attribute name="maxlength" required="false" default="50" />
		
		<!-- types: text, number, calendar(date), autoComplete -->
		<cc:attribute name="type" default="text" required="false"  />
		<cc:attribute name="title" default="#{cc.attrs.type eq 'date' ? 'Informar data' : 'Informar valor'}" required="false" />
		<cc:attribute name="requiredMessage" default="Preencher campos obrigatórios (*)" required="false" />
		
		<!-- autoComplete params -->
		<cc:attribute name="bean" required="false"  />
		<cc:attribute name="completeMethod" required="false"  />
		<cc:attribute name="var" required="true"  />
		<cc:attribute name="itemValue" required="true"  />
		<cc:attribute name="itemLabel" required="true"  />
		<cc:attribute name="immediate" required="false" default="false"  />
		
		<!-- events -->
		<cc:attribute name="ajax" default="false" required="false"  />
		<!-- FIXME corrigir eventName, está dando erro, nao obtem o valor definido -->
		<cc:attribute name="eventName" default="#{cc.attrs.type eq 'date' ? 'dateSelect' : 'blur'}" required="false"  />
		
	</cc:interface>
	
	<cc:implementation>
	
		<h:panelGrid columns="#{not empty cc.attrs.label ? 2 : 1}" width="500" columnClasses="input_label, input_required">
		 		
	 		<p:column width="150" rendered="#{not empty cc.attrs.label}" >
				<h:outputLabel value="#{cc.attrs.label}" for="#{cc.attrs.id}"/>
		 		<h:outputText value="  * " styleClass="input_required" rendered="#{cc.attrs.required}" />
	 		</p:column>
	 		
	 		<p:column>
	 			<c:if test="#{cc.attrs.type eq 'text'}">
		 			<!-- Input Text -->
					<p:inputText id="tx_#{cc.attrs.id}" value="#{cc.attrs.value}" maxlength="#{cc.attrs.maxlength}" required="#{cc.attrs.required}" requiredMessage="#{cc.attrs.requiredMessage}" size="#{cc.attrs.size}" immediate="#{cc.attrs.immediate}" >
						<ui:insert />
						<c:if test="#{cc.attrs.ajax}">
							<p:ajax event="blur" update="tx_#{cc.attrs.id}" />  
						</c:if>
					</p:inputText>
					<h:message for="#{cc.attrs.id}" styleClass="error"  />
	 			</c:if>
	 		
	 			<c:if test="#{cc.attrs.type eq 'number'}">
		 			<!-- Input Number -->
		 			<pe:inputNumber id="nb_#{cc.attrs.id}" value="#{cc.attrs.value}" decimalSeparator="," thousandSeparator="."  dir="RTL" required="#{cc.attrs.required}" requiredMessage="#{cc.attrs.requiredMessage}" immediate="#{cc.attrs.immediate}" >
		 				<ui:insert />
						<c:if test="#{cc.attrs.ajax}">
							<p:ajax event="blur" update="nb_#{cc.attrs.id}" />  
						</c:if>
		 			</pe:inputNumber> 
					<h:message for="#{cc.attrs.id}" styleClass="error"  />
	 			</c:if>
	 		
	 			<c:if test="#{cc.attrs.type eq 'date'}">
		 			<!-- Calendar -->
		 			<p:calendar id="dt_#{cc.attrs.id}"
		 						maxlength="10"
								size="12" 
								immediate="#{cc.attrs.immediate}" 
								required="#{cc.attrs.required}"
								requiredMessage="#{cc.attrs.requiredMessage}"
								value="#{cc.attrs.value}"
								title="#{cc.attrs.title}" 
								mask="99/99/9999" >
						<ui:insert />
						<c:if test="#{cc.attrs.ajax}">
							<p:ajax event="dateSelect" update="dt_#{cc.attrs.id}" />  
						</c:if>
					</p:calendar>
					<h:message for="#{cc.attrs.id}" styleClass="error"  />
	 			</c:if>
	 		
	 			<c:if test="#{cc.attrs.type eq 'autoComplete'}">
		 			<!-- Input AutoComplete -->
					<p:autoComplete id="ac_#{cc.attrs.id}"
			                        required="#{cc.attrs.required}"
									requiredMessage="#{cc.attrs.requiredMessage}"
		            				value="#{cc.attrs.value}"
		            				title="#{cc.attrs.title}" 
		            				completeMethod="#{cc.attrs.bean[cc.attrs.completeMethod]}"  
			                        var="item"
			                        itemLabel="#{cc.attrs.itemLabel}" 
			                        itemValue="#{cc.attrs.item}" 
			                        size="#{cc.attrs.size}" 
			                        immediate="#{cc.attrs.immediate}"
			                        forceSelection="true" >
							<ui:insert />
							<c:if test="#{cc.attrs.ajax}">
								<p:ajax event="itemSelect" update="ac_#{cc.attrs.id}" />  
							</c:if>
							
                      </p:autoComplete>
					<h:message for="#{cc.attrs.id}" styleClass="error"  />
	 			</c:if>
	 		
	 		</p:column>
	 		
		</h:panelGrid>
		
	</cc:implementation>
	
</html>
